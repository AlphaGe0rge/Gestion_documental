<div class="table-responsive">
  <div class="d-flex justify-content-between mb-2">
    <div>
      <button class="btn btn-primary" (click)="addRow()" *ngIf="editable"><i class="bi bi-plus-lg"></i></button>
    </div>
  </div>

  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th *ngIf="showSelector" style="width: 20px;">
          <input type="checkbox" (change)="selectAll($event)" />
        </th>
        <td *ngIf="showDelete" style="width: 20px;">
        </td>
        <td *ngIf="showEdit" style="width: 20px;">
        </td>
        <th *ngFor="let column of columns" [hidden]="!column.show">
          {{ column.name }}
        </th>
      </tr>
    </thead>

    <tbody>
      <tr *ngIf="paginatedData.length === 0">
        <td [attr.colspan]="columns.length + 1" class="text-center">No data available</td>
      </tr>

      <ng-container *ngFor="let row of paginatedData">
        <tr>
          <td *ngIf="showSelector" style="width: 20px;">
            <input type="checkbox" [(ngModel)]="row.selected" />
          </td>
          <td *ngIf="showDelete" style="width: 20px;">
            <button class="btn btn-sm btn-danger" (click)="deleteRow(row)" *ngIf="showDelete"><i class="bi bi-trash"></i></button>
          </td>
          <td *ngIf="showEdit" style="width: 20px;">
            <button class="btn btn-sm" (click)="edit(row)" *ngIf="showEdit"><i class="bi bi-pencil-fill"></i></button>
          </td>
          <td *ngFor="let column of columns" [hidden]="!column.show" [ngStyle]="{'width': column.width ? column.width : 'auto'}">
            <input *ngIf="column.editable" [(ngModel)]="row[column.field]" />
            <span *ngIf="!column.editable">{{ row[column.field] }}</span>
          </td>
          <td *ngIf="showTree || editable" style="width: 20px;">
            <button class="btn btn-sm btn-danger" (click)="deleteRow(row)" *ngIf="showDelete"><i class="bi bi-trash"></i></button>
            <button class="btn btn-sm btn-info" *ngIf="showTree" (click)="toggleRowExpansion(row)">
              <i class="bi" [ngClass]="row.isExpanded ? 'bi-caret-up-fill' : 'bi-caret-down-fill'"></i>
            </button>
          </td>
        </tr>

        <tr *ngIf="row.isExpanded">
          <td [attr.colspan]="columns.length + 1">
            <div class="child-table">
              <table class="table">
                <thead>
                  <tr>
                    <th *ngFor="let childColumn of childColumns">{{ childColumn.name }}</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngIf="!row.childData || row.childData.length === 0">
                    <td [attr.colspan]="childColumns.length" class="text-center">No data available</td>
                  </tr>
                  <tr *ngFor="let childRow of row.childData">
                    <td *ngFor="let childColumn of childColumns">
                      {{ childRow[childColumn.field] }}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </td>
        </tr>
      </ng-container>
    </tbody>
  </table>
  
  <nav>
    <ul class="pagination justify-content-center">
      <li class="page-item" [class.disabled]="currentPage === 1" (click)="previousPage()">
        <a class="page-link">Previous</a>
      </li>
      <li class="page-item" *ngFor="let page of totalPages" [class.active]="currentPage === page" (click)="setPage(page)">
        <a class="page-link">{{ page }}</a>
      </li>
      <li class="page-item" [class.disabled]="currentPage === totalPages.length" (click)="nextPage()">
        <a class="page-link">Next</a>
      </li>
    </ul>
  </nav>
</div>

